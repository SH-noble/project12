<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>長官今年幾歲了</title>
  <meta name="description" content="寵物年齡換算器：輸入名子與出生年月日，計算毛孩年齡（幾歲又幾天）並換算成人類年齡。" />

  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      min-width: 320px;
      overflow-x: hidden;
    }

    *, *:before, *:after {
      box-sizing: inherit
    }

    .app-root {
      font-family: "Microsoft JhengHei", "PingFang TC", "Noto Sans TC", Arial, sans-serif;
      line-height: 1.4;
      color: #222;
      background: #fff;
      padding: 16px;
      min-height: 100vh;
    }

    .page-title {
      font-size: 1.6rem;
      margin: 0 0 12px 0;
      font-weight: 700
    }

    .card {
      display: flex;
      flex-direction: column;
      gap: 16px;
      max-width: 1000px;
      margin: 0 auto;
    }

    @media(min-width:720px) {
      .card {
        flex-direction: row;
        gap: 24px;
      }
    }

    .left-col {
      flex: 1;
    }

    .img-box {
      width: 100%;
      aspect-ratio: 4/3;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px;
      border: 3px solid #FFD4B3;
      border-radius: 10px;
    }

    .right-col {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px
    }

    .form-row {
      display: flex;
      flex-direction: column;
      gap: 8px
    }

    .label {
      font-size: .95rem;
      font-weight: 600
    }

    .input,
    .btn {
      font-size: 1rem;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
    }

    .btn {
      background: #FF8C42;
      color: #fff;
      cursor: pointer
    }

    .result {
      background: #FFF7EE;
      padding: 12px;
      border-radius: 8px;
      border: 1px dashed #FFD4B3
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.45);
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .modal {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      width: 90%;
      max-width: 420px;
    }
  </style>
</head>

<body>
  <div class="app-root">
    <h1 class="page-title">長官今年幾歲了</h1>

    <div class="card">
      <div class="left-col">
        <div class="img-box"></div>
      </div>

      <div class="right-col">
        <div class="form-row">
          <label class="label">毛孩名子</label>
          <input class="input" id="dog-name" />
        </div>

        <div class="form-row">
          <label class="label">輸入出生年月日</label>
          <input class="input" id="dog-birth" type="date" />
        </div>

        <button class="btn" id="calc-btn">開始計算</button>

        <div class="form-row">
          <div class="result" id="result-area"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="welcome-modal">
    <div class="modal">
      <h2>是不是想知道你的毛小孩幾歲~</h2>
      <button id="modal-close-btn">馬上來算</button>
    </div>
  </div>

  <script>
  /* ===== [JS: 主計算邏輯開始] ===== */

  (function () {
    const calcBtn = document.getElementById('calc-btn');
    const nameInput = document.getElementById('dog-name');
    const birthInput = document.getElementById('dog-birth');
    const resultArea = document.getElementById('result-area');

    function convertToHumanAge(dogAgeYears) {
      if (dogAgeYears <= 0) return null;
      return Math.round((16 * Math.log(dogAgeYears) + 31) * 10) / 10;
    }

    calcBtn.addEventListener('click', () => {
      const name = nameInput.value || '毛孩';
      const birthVal = birthInput.value;
      const birthDate = new Date(birthVal);
      const today = new Date();
      const totalDays = Math.floor((today - birthDate) / 86400000);
      const years = Math.floor(totalDays / 365.2425);
      const days = totalDays % 365;

      let humanAge = convertToHumanAge(totalDays / 365.2425);
      if (humanAge !== null && humanAge < 1) humanAge = 0;

      const html = `
        <div style="font-size:1.2rem;font-weight:800">${name} 已經：</div>
        <div style="font-size:1.4rem">${years} 歲 ${days} 天</div>
        <div>換算成人類約 ${humanAge} 歲</div>
      `;

      resultArea.innerHTML = html;

      /* ===== [JS: LocalStorage 儲存開始] ===== */
      localStorage.setItem("lastDogAgeResult", html);
      /* ===== [JS: LocalStorage 儲存結束] ===== */
    });
  })();

  /* ===== [JS: LocalStorage 載入開始] ===== */
  document.addEventListener('DOMContentLoaded', function () {
    const resultArea = document.getElementById('result-area');
    const last = localStorage.getItem("lastDogAgeResult");
    if (last) resultArea.innerHTML = last;
  });
  /* ===== [JS: LocalStorage 載入結束] ===== */
  </script>

</body>
</html>
