<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•·å®˜ä»Šå¹´å¹¾æ­²äº†</title>
  <meta name="description" content="å¯µç‰©å¹´é½¡æ›ç®—å™¨ï¼šè¼¸å…¥åå­èˆ‡å‡ºç”Ÿå¹´æœˆæ—¥ï¼Œè¨ˆç®—æ¯›å­©å¹´é½¡ä¸¦æ›ç®—æˆäººé¡å¹´é½¡">
  <style>
    html, body { margin:0; padding:0; font-family:"Microsoft JhengHei","PingFang TC","Noto Sans TC",Arial,sans-serif; background:#fff; color:#222; min-width:320px; }
    .app-root { padding:16px; max-width:1000px; margin:0 auto; }
    .page-title { font-size:1.6rem; margin-bottom:12px; font-weight:700; }
    .card { display:flex; flex-direction:column; gap:16px; }
    @media(min-width:720px){ .card { flex-direction:row; gap:24px; } }
    .left-col, .right-col { flex:1; }
    .img-box { width:100%; aspect-ratio:4/3; border:3px solid #FFD4B3; border-radius:10px; overflow:hidden; display:flex; justify-content:center; align-items:center; }
    .img-box img { width:100%; height:100%; object-fit:cover; border-radius:6px; }
    .form-row { display:flex; flex-direction:column; gap:8px; margin-bottom:12px; }
    .label { font-weight:600; font-size:.95rem; }
    .input, .btn { padding:10px 12px; font-size:1rem; border-radius:8px; border:1px solid #ddd; outline:none; }
    .btn { background:#FF8C42; color:#fff; border:none; cursor:pointer; }
    .btn:active { transform:translateY(1px); }
    .result { background:#FFF7EE; padding:12px; border-radius:8px; border:1px dashed #FFD4B3; }
    .muted { font-size:.9rem; color:#666; margin-top:6px; }
    .note { font-size:.85rem; color:#777; margin-top:10px; }
    .modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,.45); display:flex; justify-content:center; align-items:center; z-index:50; }
    .modal { background:#fff; padding:20px; border-radius:12px; max-width:90%; width:420px; box-shadow:0 10px 30px rgba(0,0,0,.2); text-align:center; }
    .modal-close { padding:10px 14px; border-radius:8px; background:#FF8C42; color:#fff; border:none; cursor:pointer; margin-top:12px; }
  </style>
</head>
<body>
  <div class="app-root">
    <h1 class="page-title">é•·å®˜ä»Šå¹´å¹¾æ­²äº†</h1>

    <div class="card">
      <div class="left-col">
        <div class="img-box">
          <img src="https://images.unsplash.com/photo-1715436366960-d0a8af92c981?q=80&w=1025&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="å¯æ„›ç‹—ç‹—">
        </div>
      </div>

      <div class="right-col">
        <div class="form-row">
          <label class="label" for="dog-name">æ¯›å­©åå­</label>
          <input class="input" id="dog-name" placeholder="ä¾‹å¦‚ï¼šå°ç™½">
        </div>
        <div class="form-row">
          <label class="label" for="dog-birth">è¼¸å…¥å‡ºç”Ÿå¹´æœˆæ—¥</label>
          <input class="input" id="dog-birth" type="date">
          <div class="muted">è«‹é¸æ“‡æ¯›å­©å‡ºç”Ÿæ—¥æœŸï¼ˆå¹´/æœˆ/æ—¥ï¼‰</div>
        </div>
        <button class="btn" id="calc-btn">é–‹å§‹è¨ˆç®—</button>

        <div class="form-row">
          <div class="result" id="result-area"></div>
        </div>
        <p class="note">* æ›ç®—æˆäººé¡å¹´é½¡ä½¿ç”¨å…¬å¼ï¼šhuman_age = 16 Ã— ln(dog_age_years) + 31</p>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="welcome-modal">
    <div class="modal">
      <h2>æ˜¯ä¸æ˜¯æƒ³çŸ¥é“ä½ çš„æ¯›å°å­©å¹¾æ­²~</h2>
      <button class="modal-close" id="modal-close-btn">é¦¬ä¸Šä¾†ç®—</button>
    </div>
  </div>

  <script>
    (function(){
      const modal = document.getElementById('welcome-modal');
      const modalClose = document.getElementById('modal-close-btn');
      const calcBtn = document.getElementById('calc-btn');
      const nameInput = document.getElementById('dog-name');
      const birthInput = document.getElementById('dog-birth');
      const resultArea = document.getElementById('result-area');

      // é—œé–‰ modal
      modalClose.addEventListener('click',()=>{ modal.style.display='none'; });
      modal.addEventListener('click',(e)=>{ if(e.target===modal) modal.style.display='none'; });

      // è¨ˆç®—ç‹—å¹´é½¡
      function computeAgeYearsDays(birthDate, today){
        if(!(birthDate instanceof Date)||isNaN(birthDate)) return null;
        if(!(today instanceof Date)||isNaN(today)) return null;
        if(today<birthDate) return null;
        let years = today.getFullYear()-birthDate.getFullYear();
        const bm=birthDate.getMonth(), bd=birthDate.getDate();
        const tm=today.getMonth(), td=today.getDate();
        if(tm<bm||(tm===bm&&td<bd)) years--;
        const lastBirthday = new Date(today.getFullYear()-(tm<bm||(tm===bm&&td<bd)?1:0), bm, bd);
        const start=(lastBirthday<birthDate)?birthDate:lastBirthday;
        const msPerDay=24*60*60*1000;
        const days=Math.floor((today-start)/msPerDay);
        return {years,days};
      }

      // æ›ç®—æˆäººé¡å¹´é½¡
      function convertToHumanAge(dogYears){
        if(dogYears<=0) return 0;
        return Math.round((16*Math.log(dogYears)+31)*10)/10;
      }

      calcBtn.addEventListener('click',()=>{
        const name=(nameInput.value||'æ¯›å­©').trim();
        const birthVal=birthInput.value;
        if(!birthVal){
          resultArea.innerHTML='<div style="color:#C04A00;font-weight:700">âš ï¸ è«‹å…ˆé¸æ“‡æ¯›å­©çš„å‡ºç”Ÿæ—¥æœŸå”·ï¼</div>';
          return;
        }
        const birthDate=new Date(birthVal+'T00:00:00');
        const today=new Date();
        const age=computeAgeYearsDays(birthDate,today);
        if(age===null){
          resultArea.innerHTML='<div style="color:#C04A00;font-weight:700">âš ï¸ æ—¥æœŸæ ¼å¼éŒ¯èª¤ï¼Œè«‹é‡æ–°é¸æ“‡</div>';
          return;
        }
        const dogAgeDecimal=(today-birthDate)/(365.2425*24*60*60*1000);
        let humanAge=convertToHumanAge(dogAgeDecimal);
        if(humanAge<1) humanAge=0;

        const html=`
          <div style="font-size:1.2rem;font-weight:800;color:#FF7A18;margin-bottom:6px">ğŸ‰ ${name} ä¾†åˆ°é€™å€‹ä¸–ç•Œä¸Šå·²ç¶“</div>
          <div style="font-size:1.35rem;font-weight:900;color:#222;margin-bottom:10px">${age.years} æ­²åˆ ${age.days} å¤© ğŸ¾</div>
          <div style="font-size:1.05rem;color:#333">ğŸ‘¤ æ›ç®—æˆäººé¡å¹´é½¡å¤§ç´„æ˜¯ï¼š${humanAge} æ­²</div>
          <div class="muted" style="margin-top:10px">â€» äººé¡å¹´é½¡æ›ç®—å…¬å¼ï¼š16 Ã— ln(dog_age_years) + 31</div>
        `;
        resultArea.innerHTML=html;

        // å­˜å…¥ localStorage
        localStorage.setItem('lastDogAgeResult', html);
      });

      // è¼‰å…¥ localStorage ä¸Šæ¬¡çµæœ
      document.addEventListener('DOMContentLoaded',()=>{
        const last=localStorage.getItem('lastDogAgeResult');
        if(last) resultArea.innerHTML=last;
      });

    })();
  </script>
</body>
</html>
