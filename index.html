<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>é•·å®˜ä»Šå¹´å¹¾æ­²äº†</title>
    <meta name="description" content="å¯µç‰©å¹´é½¡æ›ç®—å™¨ï¼šè¼¸å…¥åå­èˆ‡å‡ºç”Ÿå¹´æœˆæ—¥ï¼Œè¨ˆç®—æ¯›å­©å¹´é½¡ï¼ˆå¹¾æ­²åˆå¹¾å¤©ï¼‰ä¸¦æ›ç®—æˆäººé¡å¹´é½¡ã€‚" />
    <!-- å…¨éƒ¨ CSS æ”¾åœ¨æ­¤å–®ä¸€ style æ¨™ç±¤ï¼ˆç¦æ­¢ä½¿ç”¨ ID é¸æ“‡å™¨ï¼‰ -->
    <style>
        /* å…¨åŸŸè¨­å®šï¼Œé¿å…æ°´å¹³æ»¾å‹• */
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            min-width: 320px;
            overflow-x: hidden;
        }

        *,
        *:before,
        *:after {
            box-sizing: inherit
        }

        /* å­—é«”åå¥½ï¼šå¾®è»Ÿæ­£é»‘é«”å„ªå…ˆï¼Œfallbackç‚ºå¸¸ç”¨ç³»çµ±å­— */
        .app-root {
            font-family: "Microsoft JhengHei", "PingFang TC", "Noto Sans TC", "Helvetica Neue", Arial, sans-serif;
            line-height: 1.4;
            color: #222;
            background: #fff;
            padding: 16px;
            min-height: 100vh;
        }

        /* å¤§æ¨™é¡Œ */
        .page-title {
            font-size: 1.6rem;
            margin: 0 0 12px 0;
            font-weight: 700
        }

        /* ç‰ˆé¢ï¼šæ‰‹æ©Ÿå„ªå…ˆå–®æ¬„ï¼Œå¯¬è¢å¹•è®Šé›™æ¬„ï¼ˆåœ–ç‰‡å·¦ã€è¡¨å–®å³ï¼‰ */
        .card {
            display: flex;
            flex-direction: column;
            gap: 16px;
            max-width: 1000px;
            margin: 0 auto;
        }

        @media(min-width:720px) {
            .card {
                flex-direction: row;
                align-items: flex-start;
                gap: 24px;
            }
        }

        /* å·¦å´åœ–ç‰‡å€ */
        .left-col {
            flex: 1;
            min-width: 0
        }

        /* min-width:0 é˜²æ­¢å½ˆæ€§é …ç›®è¶…å‡º */
        .img-box {
            width: 100%;
            aspect-ratio: 4/3;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px;
            border: 3px solid #FFD4B3;
            /* æ·ºæ©˜è‰²å¯¦ç·šé‚Šæ¡† */
            border-radius: 10px;
            background: #fff;
            overflow: hidden
        }

        .img-box svg {
            max-width: 100%;
            height: auto;
            display: block
        }

        /* å³å´è¡¨å–®å€ */
        .right-col {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            gap: 12px
        }

        .form-row {
            display: flex;
            flex-direction: column;
            gap: 8px
        }

        .label {
            font-size: .95rem;
            font-weight: 600
        }

        .input,
        .btn {
            font-size: 1rem;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid #ddd;
            outline: none
        }

        .input[type="date"] {
            padding: 8px 10px
        }

        .btn {
            background: #FF8C42;
            color: #fff;
            border: none;
            cursor: pointer
        }

        .btn:active {
            transform: translateY(1px)
        }

        .result {
            background: #FFF7EE;
            padding: 12px;
            border-radius: 8px;
            border: 1px dashed #FFD4B3
        }

        .muted {
            font-size: .9rem;
            color: #666
        }

        /* æç¤ºå°å­— */
        .note {
            font-size: .85rem;
            color: #777
        }

        /* Modal è¦†è“‹å±¤èˆ‡å…§å®¹ */
        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.45);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50
        }

        .modal {
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            max-width: 90%;
            width: 420px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2)
        }

        .modal h2 {
            margin: 0 0 12px 0;
            font-size: 1.2rem
        }

        .modal p {
            margin: 0 0 16px 0
        }

        .modal .modal-close {
            display: inline-block;
            padding: 10px 14px;
            border-radius: 8px;
            background: #FF8C42;
            color: #fff;
            border: none;
            cursor: pointer
        }

        /* éŸ¿æ‡‰å¼ï¼šé¿å…æ°´å¹³æ»¾å‹• */
        @media(max-width:719px) {
            .page-title {
                font-size: 1.3rem
            }

            .img-box {
                aspect-ratio: 16/9
            }
        }

        /* è¨»è§£æ’æ§½ç¯„ä¾‹ï¼ˆå¯åˆªï¼‰ï¼šä¸‹é¢ class å¯æ›¿æ›ç‚ºè‡ªè¨‚æ¨£å¼ */
        /* <!-- è¨»è§£æ’æ§½ï¼šè‹¥è¦æ›´æ›ä¸»è‰²ï¼Œä¿®æ”¹ .btn èˆ‡ .img-box border é¡è‰² --> */
    </style>
</head>

<body>
    <div class="app-root">
        <!-- ä¸»æ¨™é¡Œ -->
        <h1 class="page-title">é•·å®˜ä»Šå¹´å¹¾æ­²äº†</h1>

        <div class="card">

            <!-- å·¦å´ï¼šåœ–ç‰‡å€ï¼ˆç¶²è·¯åœ–ç‰‡é ç•™ä½ç½®ï¼Œä¹‹å¾Œè‡ªè¡Œè£œä¸Š srcï¼‰ -->
            <div class="left-col">
                <div class="img-box">
                    <!-- è¨»è§£æ’æ§½ï¼šé€™è£¡ä¹‹å¾Œå¡«å…¥ä½ çš„åœ–ç‰‡ç¶²å€ -->
                    <img src="https://images.unsplash.com/photo-1715436366960-d0a8af92c981?q=80&w=1025&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
                        alt="ä¸€éš»å¯æ„›çš„ç™½è‰²å¤§ç‹—ç‹—ç…§ç‰‡" style="width:100%;height:100%;object-fit:cover;border-radius:6px;" />
                </div>

            </div>

            <!-- å³å´ï¼šè¡¨å–®èˆ‡çµæœ -->
            <div class="right-col">
                <!-- è¨»è§£æ’æ§½ï¼šè‹¥è¦æ–°å¢æ¬„ä½ï¼ˆå“ç¨®/é«”å‹ï¼‰ï¼Œå¯åœ¨æ­¤åŠ å…¥ input -->
                <div class="form-row">
                    <label class="label" for="dog-name">æ¯›å­©åå­</label>
                    <input class="input" id="dog-name" name="dog-name" type="text" placeholder="è¼¸å…¥æ¯›å­©çš„åå­ï¼ˆä¾‹å¦‚ï¼šå°ç™½ï¼‰" />
                </div>

                <div class="form-row">
                    <label class="label" for="dog-birth">è¼¸å…¥å‡ºç”Ÿå¹´æœˆæ—¥</label>
                    <input class="input" id="dog-birth" name="dog-birth" type="date" />
                    <div class="muted">è«‹é¸æ“‡æ¯›å­©å‡ºç”Ÿæ—¥æœŸï¼ˆå¹´/æœˆ/æ—¥ï¼‰</div>
                </div>

                <div class="form-row">
                    <button class="btn" id="calc-btn" type="button">é–‹å§‹è¨ˆç®—</button>
                </div>

                <div class="form-row">
                    <div class="result" id="result-area" aria-live="polite">
                        <!-- è¨»è§£æ’æ§½ï¼šåˆå§‹ç‹€æ…‹ä¸é¡¯ç¤ºä»»ä½•æ–‡å­— -->
                    </div>
                </div>

            </div>
        </div>

        <p class="note">* æ›ç®—æˆäººé¡å¹´é½¡ä½¿ç”¨å…¬å¼ï¼šhuman_age = 16 Ã— ln(dog_age_years) + 31ï¼ˆç ”ç©¶åŸºæ–¼ç”²åŸºåŒ–æ™‚é˜ï¼‰ã€‚</p>
    </div>
    </div>
    </div>

    <!-- Modalï¼šç¶²é æ‰“é–‹æ™‚é¡¯ç¤ºæ­¡è¿è¦–çª— -->
    <div class="modal-backdrop" id="welcome-modal" role="dialog" aria-modal="true" style="display:flex">
        <div class="modal" role="document">
            <h2>æ˜¯ä¸æ˜¯æƒ³çŸ¥é“ä½ çš„æ¯›å°å­©å¹¾æ­²~</h2>
            <p>è¼¸å…¥åå­èˆ‡å‡ºç”Ÿæ—¥æœŸï¼Œæˆ‘æœƒå¹«ä½ ç®—å‡ºã€Œå¹¾æ­²åˆå¹¾å¤©ã€ï¼Œä¸¦æ›ç®—æˆç›¸ç•¶æ–¼äººçš„å¹´é½¡ã€‚</p>
            <button class="modal-close" id="modal-close-btn" type="button">é¦¬ä¸Šä¾†ç®—</button>
        </div>
    </div>

    <!-- JavaScriptï¼šæ”¾åœ¨ body å…§ï¼ˆä¸å½±éŸ¿ CSS è¦å‰‡ï¼‰ -->
    <script>
        /* è¨»è§£æ’æ§½ï¼šJS å¯ä¾éœ€æ±‚æ“´å……ï¼ˆå¢åŠ é«”å‹é¸é …ã€å“ç¨®ä¿®æ­£ç­‰ï¼‰ */
        (function () {
            // å…ƒä»¶åƒè€ƒï¼ˆä½¿ç”¨ class ç‚ºä¸»ï¼Œä½†æ­¤è™•ç‚ºæ“æ§ç°¡å–®ä½¿ç”¨ getElementById ä½œç‚ºå…§éƒ¨å¯¦ä½œï¼‰
            const modal = document.getElementById('welcome-modal');
            const modalClose = document.getElementById('modal-close-btn');
            const calcBtn = document.getElementById('calc-btn');
            const nameInput = document.getElementById('dog-name');
            const birthInput = document.getElementById('dog-birth');
            const resultArea = document.getElementById('result-area');

            // é—œé–‰ modalï¼ˆé»æŒ‰éˆ•æˆ–é»èƒŒæ™¯é—œé–‰ï¼‰
            modalClose.addEventListener('click', () => { modal.style.display = 'none'; });
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.style.display = 'none';
            });

            // å·¥å…·ï¼šè¨ˆç®—æ—¥æœŸå·®ï¼ˆå®Œæ•´å¹´æ•¸ + å‰©é¤˜å¤©æ•¸ï¼‰
            function computeAgeYearsDays(birthDate, refDate) {
                // birthDate, refDate ç‚º Date ç‰©ä»¶ï¼ˆUTC æœ¬è³ªä¸é‡è¦ï¼Œä½¿ç”¨ç•¶åœ°æ™‚é–“ï¼‰
                if (!(birthDate instanceof Date) || isNaN(birthDate)) return null;
                if (!(refDate instanceof Date) || isNaN(refDate)) return null;
                if (refDate < birthDate) return null;

                // è¨ˆç®—æ•´å¹´æ•¸ï¼ˆæ­²ï¼‰
                let years = refDate.getFullYear() - birthDate.getFullYear();
                // èª¿æ•´æ˜¯å¦å·²éç”Ÿæ—¥
                const refMonth = refDate.getMonth();
                const refDay = refDate.getDate();
                const birthMonth = birthDate.getMonth();
                const birthDay = birthDate.getDate();
                if (refMonth < birthMonth || (refMonth === birthMonth && refDay < birthDay)) {
                    years -= 1;
                }
                // è¨ˆç®—å¾æœ€å¾Œç”Ÿæ—¥åˆ° refDate çš„å¤©æ•¸
                const lastBirthday = new Date(refDate.getFullYear() - ((refMonth < birthMonth || (refMonth === birthMonth && refDay < birthDay)) ? 1 : 0), birthMonth, birthDay);
                // è‹¥ lastBirthday åœ¨å‡ºç”Ÿæ—¥å‰ï¼ˆä¾‹å¦‚å‡ºç”Ÿç•¶å¹´ç”Ÿæ—¥å°šæœªåˆ°ä¸”å¹´æ•¸ç‚º0ï¼‰ï¼Œéœ€ä»¥å‡ºç”Ÿæ—¥åšèµ·é»
                const start = (lastBirthday < birthDate) ? birthDate : lastBirthday;
                const msPerDay = 24 * 60 * 60 * 1000;
                const days = Math.floor((refDate - start) / msPerDay);
                return { years: years, days: days };
            }

            // æ›ç®—æˆäººå¹´é½¡å‡½å¼ï¼ˆä½¿ç”¨å…¬å¼ human_age = 16 * ln(dog_age_years) + 31ï¼‰
            function convertToHumanAge(dogAgeYears) {
                // è‹¥å°æ–¼å¾ˆå°çš„å€¼ï¼ˆä¾‹å¦‚ 0ï¼‰ï¼Œé¿å… ln(0) æˆ–è² å€¼
                if (dogAgeYears <= 0) return null;
                // è‹¥ç‹—å¹´ < 0.01ï¼ˆä¸è¶³ç´„3.65å¤©ï¼‰ï¼Œè¦–ç‚ºä¸åˆ°ä¸€å¤©
                const val = 16 * Math.log(dogAgeYears) + 31;
                // å°æ–¼å¹¼çŠ¬ï¼ˆå°æ–¼1å¹´ï¼‰ï¼Œå…¬å¼æœƒçµ¦è¼ƒé«˜å€¼ï¼Œä½†é€™æ˜¯ç ”ç©¶çµæœçš„æ•¸å­¸è¡¨é”
                // é¡¯ç¤ºåˆ°å°æ•¸é»å¾Œä¸€ä½
                return Math.round(val * 10) / 10;
            }

            // ä¸»è¦æŒ‰éˆ•è™•ç†
            calcBtn.addEventListener('click', () => {
                const name = (nameInput.value || '').trim() || 'æ¯›å­©';
                const birthVal = birthInput.value;

                if (!birthVal) {
                    resultArea.innerHTML = `
      <div style="color:#C04A00;font-weight:700;font-size:1.1rem">
        âš ï¸ è«‹å…ˆé¸æ“‡æ¯›å­©çš„å‡ºç”Ÿæ—¥æœŸå”·ï¼
      </div>
    `;
                    return;
                }

                const birthDate = new Date(birthVal + 'T00:00:00');
                const today = new Date();

                const age = computeAgeYearsDays(birthDate, today);
                if (age === null) {
                    resultArea.innerHTML = `
      <div style="color:#C04A00;font-weight:700;font-size:1.1rem">
        âš ï¸ æ—¥æœŸæ ¼å¼éŒ¯èª¤ï¼Œè«‹é‡æ–°é¸æ“‡
      </div>
    `;
                    return;
                }

                const msPerDay = 24 * 60 * 60 * 1000;
                const totalDays = Math.floor((today - birthDate) / msPerDay);
                const dogAgeYearsDecimal = totalDays / 365.2425;

                let humanAge = convertToHumanAge(dogAgeYearsDecimal);

                // âœ… è‹¥æœªæ»¿ 1 æ­²ï¼Œç›´æ¥é¡¯ç¤º 0 æ­²
                if (humanAge !== null && humanAge < 1) {
                    humanAge = 0;
                }

                const ageText = `ğŸ‰ ${name} ä¾†åˆ°é€™å€‹ä¸–ç•Œä¸Šå·²ç¶“`;
                const ageValue = `${age.years} æ­²åˆ ${age.days} å¤© ğŸ¾`;

                const humanText = (humanAge === null)
                    ? `ğŸ’¡ ${name} ç›®å‰å¤ªå°ï¼Œé‚„ç„¡æ³•ç²¾æº–æ›ç®—æˆäººé¡å¹´é½¡`
                    : `ğŸ‘¤ æ›ç®—æˆäººé¡å¹´é½¡å¤§ç´„æ˜¯ï¼š${humanAge} æ­²`;

                resultArea.innerHTML = /* ===== [JS: LocalStorage å„²å­˜æœ¬æ¬¡è¨ˆç®—çµæœé–‹å§‹] ===== */

// å°‡ç›®å‰ç•«é¢ä¸Šçš„è¨ˆç®—çµæœå­˜é€² localStorage
localStorage.setItem("lastDogAgeResult", resultArea.innerHTML);

/* ===== [JS: LocalStorage å„²å­˜æœ¬æ¬¡è¨ˆç®—çµæœçµæŸ] ===== */`
                
    <div style="font-size:1.2rem;font-weight:800;color:#FF7A18;margin-bottom:6px">
      ${ageText}
    </div>
    <div style="font-size:1.35rem;font-weight:900;color:#222;margin-bottom:10px">
      ${ageValue}
    </div>
    <div style="font-size:1.05rem;color:#333">
      ${humanText}
    </div>
    <div class="muted" style="margin-top:10px">
      â€» äººé¡å¹´é½¡æ›ç®—æ¡ç”¨ç ”ç©¶å…¬å¼ï¼šhuman_age = 16 Ã— ln(dog_age_years) + 31
    </div>
  `;
            });


            // åˆæ¬¡è¼‰å…¥è‡ªå‹•é¡¯ç¤º modalï¼ˆmodal åˆå§‹æ¨£å¼ç‚º display:flexï¼‰
            // ï¼ˆå·²ç¶“åœ¨ DOM å…§ä»¥ style æ§åˆ¶é¡¯ç¤ºï¼‰
        })();
    </script>
    <script>
    const KEY = 'my-note';
    const input = document.getElementById('note-input');
    const saveBtn = document.getElementById('save-btn');
    const display = document.getElementById('display');

    // ç¬¬ä¸€æ¬¡é€²ä¾†é é¢æ™‚ï¼Œå…ˆè©¦è‘—æŠŠèˆŠè³‡æ–™æ‹¿å‡ºä¾†
    const saved = localStorage.getItem(KEY);
    if (saved) {
      input.value = saved;
      display.textContent = 'ç›®å‰å„²å­˜çš„æ–‡å­—ï¼š' + saved;
    }

    // æŒ‰ä¸‹å„²å­˜ï¼Œå°±æŠŠæ–‡å­—å­˜é€² localStorage
    saveBtn.addEventListener('click', function () {
      const text = input.value;
      localStorage.setItem(KEY, text);
      display.textContent = text
        ? 'ç›®å‰å„²å­˜çš„æ–‡å­—ï¼š' + text
        : 'ç›®å‰é‚„æ²’æœ‰å„²å­˜ä»»ä½•æ–‡å­—ã€‚';
    });
    /* ===== [JS: LocalStorage è®€å–ä¸Šæ¬¡è¨ˆç®—çµæœé–‹å§‹] ===== */

// å¾ localStorage å–å¾—ä¸Šæ¬¡å„²å­˜çš„çµæœï¼ˆå¦‚æœå­˜åœ¨ï¼‰
const lastResultHTML = localStorage.getItem("lastDogAgeResult");

// å¦‚æœæœ‰æŠ“åˆ°è³‡æ–™ï¼Œå°±ç›´æ¥é¡¯ç¤ºåœ¨çµæœå€
if (lastResultHTML) {
  resultArea.innerHTML = lastResultHTML;
}

/* ===== [JS: LocalStorage è®€å–ä¸Šæ¬¡è¨ˆç®—çµæœçµæŸ] ===== */

  </script>
</body>

</html>